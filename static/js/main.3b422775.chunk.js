(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{256:function(e){e.exports={mainMenu:{dialogs:"Dialogs",requests:"Requests",managers:"Managers",settings:"Settings",logout:"Logout"}}},257:function(e){e.exports={Message:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",Action:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435",Delete:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",Email:"\u042d\u043b.\u041f\u043e\u0447\u0442\u0430",Nickname:"\u041d\u0438\u043a\u043d\u044d\u0439\u043c",mainMenu:{dialogs:"\u0414\u0438\u0430\u043b\u043e\u0433\u0438",requests:"\u0417\u0430\u044f\u0432\u043a\u0438",managers:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u044b",settings:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",logout:"\u0412\u044b\u0445\u043e\u0434"},dialogsList:{dialogName:"\u0418\u043c\u044f \u0434\u0438\u0430\u043b\u043e\u0433\u0430"},requests:{table:{}},buttons:{addManager:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430"},"Do you want to delete manager?":"\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430?",Yes:"\u0414\u0430",No:"\u041d\u0435\u0442",Cancel:"\u041e\u0442\u043c\u0435\u043d\u0430",Add:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",Password:"\u041f\u0430\u0440\u043e\u043b\u044c","This field is required":"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435","User already exist":"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442","Copy this code into body of your HTML":"\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u044d\u0442\u043e\u0442 \u043a\u043e\u0434 \u0432 body \u0432\u0430\u0448\u0435\u0433\u043e HTML \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430",successful:"\u0443\u0441\u043f\u0435\u0448\u043d\u043e",unsuccessful:"\u043d\u0435\u0443\u0434\u0430\u0447\u043d\u043e","Code copied":"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e","Copy failed":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f","Company name":"\u0418\u043c\u044f \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438","Chat should be open?":"\u0427\u0430\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043e\u0442\u043a\u0440\u044b\u0442","Widget color":"\u0426\u0432\u0435\u0442 \u0432\u0438\u0434\u0436\u0435\u0442\u0430","Bot name":"\u0418\u043c\u044f \u0431\u043e\u0442\u0430","Bot token":"\u0422\u043e\u043a\u0435\u043d \u0431\u043e\u0442\u0430",Phone:"\u0442\u0435\u043b\u0435\u0444\u043e\u043d","API token":"API \u0442\u043e\u043a\u0435\u043d","Group name":"\u0418\u043c\u044f \u0433\u0440\u0443\u043f\u043f\u044b","Group token":"\u0422\u043e\u043a\u0435\u043d \u0433\u0440\u0443\u043f\u043f\u044b","Confirmation code":"\u041a\u043e\u0434 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f","API key":"API \u043a\u043b\u044e\u0447",Secret:"\u0421\u0435\u043a\u0440\u0435\u0442","Page URL":"URL \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b",Save:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c","First of all select a dialog":"\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"}},282:function(e,t,a){e.exports=a(598)},392:function(e,t,a){},595:function(e,t,a){},598:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),c=a.n(s),o=a(186),i=a(253),u=a.n(i),l=a(38),p={en:{translation:a(256)},ru:{translation:a(257)}};o.a.use(u.a).use(l.a).init({resources:p,fallbackLng:"en",interpolation:{escapeValue:!1}});o.a;var m=a(37),h=a(28),d=a(93),f=a(139),g=a(260),b=a.n(g),v=a(72),E=a(262),y=a(279),O=a(44),k="SET_AUTHORIZE",x="FETCH_SETTINGS_REQUEST",w="FETCH_SETTINGS_SUCCESS",j="SAVE_SETTINGS_REQUEST",S="SAVE_SETTINGS_SUCCESS",_="FETCH_MANAGERS_REQUEST",C="FETCH_MANAGERS_SUCCESS",I="ADD_MANAGER_REQUEST",T="ADD_MANAGER_SUCCESS",A="ADD_MANAGER_ERROR",R="REMOVE_MANAGER_REQUEST",M="REMOVE_MANAGER_SUCCESS",D="FETCH_DIALOGS_REQUEST",N="FETCH_DIALOGS_SUCCESS",U="LOADER_ON",L="LOADER_OFF",P="FETCH_DIALOG_REQUEST",F="FETCH_DIALOG_SUCCESS",q="SEND_MESSAGE_REQUEST",G="SEND_MESSAGE_SUCCESS",H="SOCKET_ROOMS_CHANGED_EVENT",V="LOADER_TURN_OFF",B="FETCH_ROLE_REQUEST",z="FETCH_ROLE_SUCCESS",Q="FETCH_REQUESTS_REQUEST",J="FETCH_REQUESTS_SUCCESS",W="DELETE_REQUESTS_REQUEST",K="DELETE_REQUESTS_SUCCESS",X="FETCH_CONFIG_SUCCESS",Y={user:null,messages:[],message:null,dialogs:[],loader:!1,messagesCount:null,currentRoom:null,currentPage:1,requests:[]};var Z={app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case k:return Object(h.a)({},e,{user:t.data});case w:return Object(h.a)({},e,{widgetSettings:t.widgetSettings});case C:return Object(h.a)({},e,{managers:t.managers.managers});case T:return Object(h.a)({},e,{result:t});case A:return Object(h.a)({},e,{error_message:t.result.data});case M:return Object(h.a)({},e,{result:t.result});case N:return Object(h.a)({},e,{dialogs:t.dialogs});case U:return Object(h.a)({},e,{loader:!0});case L:return Object(h.a)({},O.omit(e,"error_message"),{loader:!1});case F:return e.currentRoom=t.data.room,e.messagesCount=t.data.messagesCount,e.currentPage=1,Object(h.a)({},e,{messages:t.data.messages.reverse()});case H:var a=t.data.fields.args[1].lastMessage;if(a){var n=null;return n=e.currentRoom&&e.currentRoom._id===a.rid?Object(y.a)(e.messages).concat([a]):e.messages,Object(h.a)({},e,{message:a,messages:n})}return Object(h.a)({},e,{message:null,messages:e.messages});case z:return Object(h.a)({},e,{role:t.role});case J:return Object(h.a)({},e,{requests:t.messages});case K:return Object(h.a)({},e,{result:t});case X:return Object(h.a)({},e,{config:t.config});default:return e}},router:v.d},$=a(5),ee=a.n($),te=a(10),ae=a(22),ne=a(45),re=a.n(ne),se=a(263),ce=a.n(se);function oe(){var e=localStorage.getItem("dialogs");return(e=!!function(e){try{JSON.parse(e)}catch(t){return!1}return!0}(e)&&JSON.parse(e))||!1}function ie(e){var t=oe();if(e){if(!t)return localStorage.setItem("dialogs",JSON.stringify(e)),!0;t.forEach(function(t){-1===O.findIndex(e,{_id:t._id})&&function(e){var t=oe();t&&e&&ue(O.filter(t,function(t){return t._id!==e._id}))}(t)}),e.forEach(function(e){-1===O.findIndex(t,{_id:e._id})&&function(e){var t=oe();t&&e&&(t.push(e),ue(t))}(e)})}return!1}function ue(e){var t=oe();e&&t&&localStorage.setItem("dialogs",JSON.stringify(e))}function le(e){var t=oe();return t&&t.forEach(function(t){var a=O.findIndex(e,{_id:t._id});e[a]&&(e[a].msgs>t.msgs?e[a].nmsgs=e[a].msgs-t.msgs:e[a].nmsgs=0)}),e}function pe(e){var t=oe();return!!t&&(t[O.findIndex(t,{_id:e._id})]=e,t)}var me=function(e,t,a){return"https://api.mixapp.io/webhooks/mixapp/".concat(e,"/").concat(t,"/").concat(a)},he=function(e){var t=JSON.parse(localStorage.getItem("XUSER")).data;return{"Content-Type":e?"application/json":"","X-Auth-Token":t.authToken,"X-User-Id":t.userId}},de=function(){return{Authorization:"Bearer "+JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json;charset=UTF-8",accept:"*/*"}},fe={companyId:"5bed9d260dec1f9f4f358399",backApiProcessId:"5bc49dd0574e7403e22ec1a0",frontApiProcessId:"5bc49dd735b38203254872a5",commentsPerPage:15},ge=function(){return fe},be=function(){var e=Object(ae.a)(ee.a.mark(function e(){var t,a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=me(fe.backApiProcessId,fe.companyId,"get-token"),e.next=4,re.a.get(t,{headers:de()});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=Object(ae.a)(ee.a.mark(function e(){var t,a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=me(fe.backApiProcessId,fe.companyId,"widget-oidc"),e.next=4,re.a.get(t,{headers:de()});case 4:return a=e.sent,e.abrupt("return",Object(h.a)({companyName:a.data.companyName},a.data.widget,a.data.settings));case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=me(fe.backApiProcessId,fe.companyId,"settings"),e.next=4,re.a.post(a,{companyName:t.companyName,widget:{isActive:t.isActive,color:t.color,openChat:t.openChat},settings:{telegram_token:t.telegram_token,telegram_bot_name:t.telegram_bot_name,viber_token:t.viber_token,viber_bot_name:t.viber_bot_name,sms_token:t.sms_token,sms_phone:t.sms_phone,vk_token:t.vk_token,vk_group_name:t.vk_group_name,vk_confirmation_code:t.vk_confirmation_code,fbm_api_key:t.fbm_api_key,fbm_secret:t.fbm_secret,fbm_page:t.fbm_page}},{headers:de()});case 4:return n=e.sent,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(ae.a)(ee.a.mark(function e(){var t,a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=me(fe.backApiProcessId,fe.companyId,"listmanagers"),e.next=4,re.a.get(t,{headers:de()});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=me(fe.backApiProcessId,fe.companyId,"addmanagers"),e.next=4,re.a.post(a,{email:t.email,nickname:t.nickname,password:t.password},{headers:de()});case 4:return n=e.sent,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=me(fe.backApiProcessId,fe.companyId,"removemanagers"),e.next=4,re.a.post(a,{id:t._id,username:t.nickname},{headers:de()});case 4:return n=e.sent,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=Object(ae.a)(ee.a.mark(function e(){var t;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re.a.get("https://chat.mixapp.io/api/v1/groups.list",{headers:he()});case 3:return t=e.sent,e.abrupt("return",le(t.data.groups));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),we=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re.a.get("https://chat.mixapp.io/api/v1/groups.history",{params:t,headers:he()});case 3:return a=e.sent,e.abrupt("return",a.data.messages);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=Object(ae.a)(ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re.a.get("https://chat.mixapp.io/api/v1/groups.info",{params:t,headers:he()});case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=me(fe.backApiProcessId,fe.companyId,"request-close"),e.next=4,re.a.post(a,t,{headers:de()});case 4:return n=e.sent,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=Object(ae.a)(ee.a.mark(function e(){var t,a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=me(fe.backApiProcessId,fe.companyId,"fetch-role"),e.next=4,re.a.get(t,{headers:de()});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(ae.a)(ee.a.mark(function e(t,a){var n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re()({method:"POST",url:"https://chat.mixapp.io/api/v1/chat.postMessage",data:{roomId:t._id,text:a},headers:he(!0)});case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}(),Ie=function(){var e=he();return Object(f.b)(function(t){var a={endpoint:"wss://chat.mixapp.io/websocket",SocketConstructor:WebSocket},n=new ce.a(a);return n.on("connected",function(){n.method("login",[{resume:e["X-Auth-Token"]}]),n.sub("stream-notify-user",[e["X-User-Id"]+"/rooms-changed",!1])}),n.on("changed",function(e){return t({type:"SOCKET_ROOMS_CHANGED_EVENT",data:e})}),function(){}})},Te=ee.a.mark(Be),Ae=ee.a.mark(ze),Re=ee.a.mark(Qe),Me=ee.a.mark(Je),De=ee.a.mark(We),Ne=ee.a.mark(Ke),Ue=ee.a.mark(Xe),Le=ee.a.mark(Ye),Pe=ee.a.mark(Ze),Fe=ee.a.mark($e),qe=ee.a.mark(et),Ge=ee.a.mark(tt),He=ee.a.mark(at),Ve=ee.a.mark(nt);function Be(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(q,ee.a.mark(function e(t){var a,n,r,s,c,o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.data,n=a.room,r=a.text,e.next=4,Ce(n,r);case 4:if(s=e.sent,c=oe(),o=O.findIndex(c,{_id:t.data.roomId}),c[o].nmsgs=0,c[o].msgs=c[o].msgs+1,ue(c),200!==s.status){e.next=13;break}return e.next=13,Object(te.c)({type:G});case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(0),e.t0;case 18:case"end":return e.stop()}},e,this,[[0,15]])}));case 2:case"end":return e.stop()}},Te,this)}function ze(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(P,ee.a.mark(function e(t){var a,n,r,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return ue(pe(a=t.data.room)),e.next=7,xe();case 7:return ie(n=e.sent),e.next=11,Object(te.c)({type:N,dialogs:n});case 11:return e.next=13,je({roomId:a._id});case 13:return r=e.sent,e.next=16,we({roomId:a._id,unreads:!0,count:t.data.count});case 16:return s=e.sent,e.next=19,Object(te.c)({type:F,data:{messages:s,room:a,messagesCount:r.data.group.msgs}});case 19:return e.next=21,Object(te.c)({type:L});case 21:e.next=26;break;case 23:throw e.prev=23,e.t0=e.catch(0),e.t0;case 26:case"end":return e.stop()}},e,this,[[0,23]])}));case 2:case"end":return e.stop()}},Ae,this)}function Qe(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(D,ee.a.mark(function e(t){var a,n,r,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return e.next=5,xe();case 5:return ie(a=e.sent),e.next=9,Object(te.c)({type:N,dialogs:a});case 9:return e.next=11,Object(te.c)({type:L});case 11:return e.next=13,Object(te.a)(Ie);case 13:n=e.sent;case 14:return e.next=17,Object(te.d)(n);case 17:return r=e.sent,e.next=20,Object(te.c)(r);case 20:return e.next=22,xe();case 22:return s=e.sent,e.next=25,Object(te.c)({type:N,dialogs:s});case 25:e.next=14;break;case 27:e.next=32;break;case 29:throw e.prev=29,e.t0=e.catch(0),e.t0;case 32:case"end":return e.stop()}},e,this,[[0,29]])}));case 2:case"end":return e.stop()}},Re,this)}function Je(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(R,ee.a.mark(function e(t){var a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return e.next=5,ke(t.data);case 5:if((a=e.sent).data.error){e.next=11;break}return e.next=9,Object(te.c)({type:M,result:a});case 9:return e.next=11,Object(te.c)({type:_});case 11:return e.next=13,Object(te.c)({type:L});case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(0),e.t0;case 18:case"end":return e.stop()}},e,this,[[0,15]])}));case 2:case"end":return e.stop()}},Me,this)}function We(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(I,ee.a.mark(function e(t){var a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return e.next=5,Oe(t.data);case 5:if((a=e.sent).data.error){e.next=13;break}return e.next=9,Object(te.c)({type:T,result:a});case 9:return e.next=11,Object(te.c)({type:_});case 11:e.next=15;break;case 13:return e.next=15,Object(te.c)({type:A,result:a});case 15:return e.next=17,Object(te.c)({type:L});case 17:e.next=22;break;case 19:throw e.prev=19,e.t0=e.catch(0),e.t0;case 22:case"end":return e.stop()}},e,this,[[0,19]])}));case 2:case"end":return e.stop()}},De,this)}function Ke(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(_,ee.a.mark(function e(t){var a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return e.next=5,ye();case 5:return(a=e.sent).error||a.managers.forEach(function(e,t){e.key=String(t+1),e.number=t+1}),e.next=9,Object(te.c)({type:C,managers:a});case 9:return e.next=11,Object(te.c)({type:L});case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}},e,this,[[0,13]])}));case 2:case"end":return e.stop()}},Ne,this)}function Xe(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(j,ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return e.next=5,Ee(t.data);case 5:return e.next=7,Object(te.c)({type:S});case 7:return e.next=9,Object(te.c)({type:L});case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}},e,this,[[0,11]])}));case 2:case"end":return e.stop()}},Ue,this)}function Ye(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(x,ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return e.t0=te.c,e.t1=w,e.next=7,ve();case 7:return e.t2=e.sent,e.t3={type:e.t1,widgetSettings:e.t2},e.next=11,(0,e.t0)(e.t3);case 11:return e.t4=te.c,e.t5=X,e.next=15,ge();case 15:return e.t6=e.sent,e.t7={type:e.t5,config:e.t6},e.next=19,(0,e.t4)(e.t7);case 19:return e.next=21,Object(te.c)({type:L});case 21:e.next=26;break;case 23:throw e.prev=23,e.t8=e.catch(0),e.t8;case 26:case"end":return e.stop()}},e,this,[[0,23]])}));case 2:case"end":return e.stop()}},Le,this)}function Ze(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(k,ee.a.mark(function e(t){var a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,localStorage.setItem("user",JSON.stringify(t.data)),e.next=4,be();case 4:return a=e.sent,localStorage.setItem("XUSER",JSON.stringify(a)),n=localStorage.getItem("redirect"),localStorage.removeItem("redirect"),e.next=10,Object(te.c)(Object(v.b)(n||"/"));case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,this,[[0,12]])}));case 2:case"end":return e.stop()}},Pe,this)}function $e(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(V,ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:L});case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,this,[[0,5]])}));case 2:case"end":return e.stop()}},Fe,this)}function et(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(B,ee.a.mark(function e(t){var a;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return e.next=5,_e();case 5:if((a=e.sent).error){e.next=9;break}return e.next=9,Object(te.c)({type:z,role:a.role});case 9:return e.next=11,Object(te.c)({type:L});case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}},e,this,[[0,13]])}));case 2:case"end":return e.stop()}},qe,this)}function tt(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(Q,ee.a.mark(function e(){var t,a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return t=ge(),e.next=6,je({roomName:"Requests_"+t.companyId});case 6:return a=e.sent,e.next=9,we({roomId:a.data.group._id,count:9999});case 9:return n=e.sent,O.each(n,function(e,t){var a="string"===typeof e.ts?new Date(e.ts):new Date(e.ts.$date);e.key=e._id,e.ts=a.toLocaleDateString()+", "+a.toLocaleTimeString()}),e.next=13,Object(te.c)({type:J,messages:n.reverse()});case 13:return e.next=15,Object(te.c)({type:L});case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(0),e.t0;case 20:case"end":return e.stop()}},e,this,[[0,17]])}));case 2:case"end":return e.stop()}},Ge,this)}function at(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.e)(W,ee.a.mark(function e(t){var a,n,r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(te.c)({type:U});case 3:return a=ge(),e.next=6,je({roomName:"Requests_"+a.companyId});case 6:if(n=e.sent,!(t.data.length>0)){e.next=17;break}r=0;case 9:if(!(r<t.data.length)){e.next=15;break}return e.next=12,Se({roomId:n.data.group._id,msgId:t.data[r]._id});case 12:r++,e.next=9;break;case 15:e.next=19;break;case 17:return e.next=19,Se({roomId:n.data.group._id,msgId:t.data._id});case 19:return e.next=21,Object(te.c)({type:Q});case 21:return e.next=23,Object(te.c)({type:L});case 23:e.next=28;break;case 25:throw e.prev=25,e.t0=e.catch(0),e.t0;case 28:case"end":return e.stop()}},e,this,[[0,25]])}));case 2:case"end":return e.stop()}},He,this)}function nt(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[Object(te.b)(Ze),Object(te.b)(Ye),Object(te.b)(Xe),Object(te.b)(Ke),Object(te.b)(We),Object(te.b)(Je),Object(te.b)(Qe),Object(te.b)(ze),Object(te.b)(Be),Object(te.b)($e),Object(te.b)(et),Object(te.b)(tt),Object(te.b)(at)];case 2:case"end":return e.stop()}},Ve,this)}var rt=ee.a.mark(st);function st(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[nt()];case 2:case"end":return e.stop()}},rt,this)}var ct=b()(),ot=Object(f.a)(),it=localStorage.getItem("user"),ut={app:{user:it?JSON.parse(it):null}},lt=Object(d.d)(Object(d.c)(Object(h.a)({},Z)),ut,Object(d.a)(E.a,ot,Object(v.c)(ct)));ot.run(st);var pt=a(16),mt=a(17),ht=a(19),dt=a(18),ft=a(20),gt=a(338),bt=a(280),vt=a(613),Et=Object(vt.a)(Object(m.b)(function(e,t){return{app:e.app}},null)(function(e){var t=e.component,a=Object(bt.a)(e,["component"]);return r.a.createElement(gt.a,Object.assign({},a,{render:function(e){return a.app.user?a.app.user?r.a.createElement(t,e):null:(localStorage.setItem("redirect",a.path),window.location.href="https://api.mixapp.io/oidc/mixapp/authorize?response_type=id_token+token&client_id=5a82de9435b3820437d23cfd&redirect_uri=http://localhost:3000/authorize&scope=openid+email+profile&state=uUpgnZBBCBMnI_GLGIzCP3AZXzavFzEVC5hM6UKB_ew&nonce=UXwkyVyGj-Lw_-zEUMbySDW2A4C5G1tYA1_HKrH0-r4&display=popup",null)}}))})),yt=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Home"),r.a.createElement("div",null,"Login"))}}]),t}(r.a.Component),Ot=function(e){return r.a.createElement(yt,e)},kt=a(612),xt=a(600),wt=a(14),jt=a(251),St=a(607),_t=function(e){function t(){var e,a;Object(pt.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(ht.a)(this,(e=Object(dt.a)(t)).call.apply(e,[this].concat(r)))).state={currentMenuKey:2},a}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentWillMount",value:function(){var e;switch(this.props.location.pathname){case"/dialogs":e=2;break;case"/managers":e=3;break;case"/requests":e=5;break;case"/settings":e=1;break;default:e=2}this.setState({currentMenuKey:e})}},{key:"render",value:function(){var e=this.props.t;return r.a.createElement(xt.a,{theme:"dark",mode:"inline",defaultSelectedKeys:[this.state.currentMenuKey.toString()]},r.a.createElement(xt.a.Item,{key:"2"},r.a.createElement(St.a,{to:"/dialogs"},r.a.createElement(wt.a,{type:"database"}),r.a.createElement("span",null,e("mainMenu.dialogs")))),r.a.createElement(xt.a.Item,{key:"5"},r.a.createElement(St.a,{to:"/requests"},r.a.createElement(wt.a,{type:"inbox"}),r.a.createElement("span",null,e("mainMenu.requests")))),"admin"===this.props.role?r.a.createElement(xt.a.Item,{key:"3"},r.a.createElement(St.a,{to:"/managers"},r.a.createElement(wt.a,{type:"team"}),r.a.createElement("span",null,e("mainMenu.managers")))):null,"admin"===this.props.role?r.a.createElement(xt.a.Item,{key:"1"},r.a.createElement(St.a,{to:"/settings"},r.a.createElement(wt.a,{type:"setting"}),r.a.createElement("span",null,e("mainMenu.settings")))):null,r.a.createElement(xt.a.Item,{key:"4"},r.a.createElement(St.a,{to:"/logout"},r.a.createElement(wt.a,{type:"upload"}),r.a.createElement("span",null,e("mainMenu.logout")))))}}]),t}(r.a.Component),Ct=Object(l.b)()(Object(vt.a)(function(e){return r.a.createElement(_t,e)})),It=(a(392),function(){return{type:x}}),Tt=function(e){return{type:j,data:e}},At=function(e){return{type:P,data:e}},Rt=function(){return{type:L}},Mt=a(610),Dt=a(601),Nt=a(616),Ut=kt.a.Sider,Lt=Mt.a.Search,Pt=function(e){function t(){var e,a;Object(pt.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(ht.a)(this,(e=Object(dt.a)(t)).call.apply(e,[this].concat(r)))).state={searchDialogText:""},a.fetchDialog=function(){var e=Object(ae.a)(ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.fetchDialog({count:15,room:t});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"searchDialog",value:function(){var e=Object(ae.a)(ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({searchDialogText:t});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.t,a=O.sortBy(this.props.app.dialogs,"nmsgs").reverse(),n=[];return a||(a=[]),a.forEach(function(t){var a=t.name.split("_"),s=a[a.length-1];function c(){return(c=Object(ae.a)(ee.a.mark(function e(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fetchDialog(t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,this,[[0,5]])}))).apply(this,arguments)}t.name=t.name.replace(s,""),-1!==t.name.search(e.state.searchDialogText)&&n.push(r.a.createElement(xt.a.Item,{key:t._id,onClick:function(){return c.apply(this,arguments)}.bind(e)},r.a.createElement("div",{className:"dialogs-item-container"},r.a.createElement(Dt.a,{size:"small"},"U"),r.a.createElement("span",null,t.name.substring(0,t.name.length-1)),t.nmsgs>0&&r.a.createElement(Nt.a,{color:"#f50"},t.nmsgs))))}),r.a.createElement(Ut,{style:{display:this.props.dialogsListShow},className:"dialogs-item-sider"},r.a.createElement("div",{className:"logo_container"},r.a.createElement("div",{className:"logo"},r.a.createElement(Lt,{placeholder:t("dialogsList.dialogName"),onSearch:function(t){return e.searchDialog(t)}}))),r.a.createElement(xt.a,{theme:"dark",mode:"inline",className:"dialogs-item-sider"},n))}}]),t}(r.a.Component),Ft=Object(l.b)()(Object(m.b)(function(e,t){return{app:e.app}},function(e,t){return{fetchDialog:function(t){e(At(t))}}})(function(e){return r.a.createElement(Pt,e)})),qt=a(209),Gt=kt.a.Header,Ht=kt.a.Sider,Vt=kt.a.Content,Bt=function(e){function t(){var e,a;Object(pt.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(ht.a)(this,(e=Object(dt.a)(t)).call.apply(e,[this].concat(r)))).state={collapsed:!1},a.changeLanguage=function(){var e=Object(ae.a)(ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.props.i18n.changeLanguage(t);case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.toggle=function(){a.setState({collapsed:!a.state.collapsed})},a}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"render",value:function(){var e=this.props,t=e.location,a=e.lng,n="/dialogs"===t.pathname?"":"none",s="content "+t.pathname.replace("/",""),c=r.a.createElement(xt.a,null,r.a.createElement(xt.a.Item,{key:"0",onClick:this.changeLanguage.bind(this,"ru")},r.a.createElement("span",null,"Russian")),r.a.createElement(xt.a.Item,{key:"1",onClick:this.changeLanguage.bind(this,"en")},r.a.createElement("div",null,"English")));return r.a.createElement(kt.a,{className:"main_layout"},r.a.createElement(Ht,{trigger:null,collapsible:!0,collapsed:this.state.collapsed},r.a.createElement("div",{className:"logo_container"},r.a.createElement("div",{className:"logo"},"LOGO")),r.a.createElement(Ct,{role:this.props.role})),r.a.createElement(Ft,{dialogsListShow:n}),r.a.createElement(kt.a,null,r.a.createElement(Gt,{className:"header"},r.a.createElement(wt.a,{className:"trigger",type:this.state.collapsed?"menu-unfold":"menu-fold",onClick:this.toggle}),r.a.createElement("div",null,r.a.createElement(jt.a,{overlay:c,trigger:["click"]},r.a.createElement("span",{className:"ant-dropdown-link",href:""},a," ",r.a.createElement(wt.a,{type:"down"}))))),"/dialogs"===t.pathname?r.a.createElement(Vt,{className:s},this.props.children):r.a.createElement(qt.a,{spinning:this.props.loader,delay:0},r.a.createElement(Vt,{className:s},this.props.children))))}}]),t}(r.a.Component),zt=Object(l.b)()(Object(vt.a)(function(e){return r.a.createElement(Bt,e)})),Qt=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentDidMount",value:function(){var e=function(e){var t={};"#"===e[0]&&(e=e.substr(1));for(var a=e.split("&"),n=0;n<a.length;n++){var r=a[n].split("=");t[r[0]]=r[1]}return t}(this.props.location.hash);e.token&&this.props.setAuthorize(e)}},{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(r.a.Component),Jt=Object(m.b)(function(e,t){return{app:e.app}},function(e,t){return{setAuthorize:function(t){e({type:k,data:t})}}})(Qt),Wt=a(605),Kt=a(252),Xt=a(608),Yt=a(611),Zt=a(615),$t=a(126),ea=a(268),ta=Wt.a.Item,aa=Kt.a.Group,na=Xt.a.Panel,ra=function(e){function t(){var e,a;Object(pt.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(ht.a)(this,(e=Object(dt.a)(t)).call.apply(e,[this].concat(r)))).state={widgetCode:!0},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFieldsAndScroll(function(e,t){e||a.props.saveSettings(t)})},a}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"handleChange",value:function(e,t){this.props.form.setFieldsValue({color:e.hex})}},{key:"fallbackCopyTextToClipboard",value:function(e){var t=this.props.t,a=document.createElement("textarea");a.value=this.widgetCode,document.body.appendChild(a),a.focus(),a.select();try{document.execCommand("copy")?Yt.a.success(t("Code copied")):Yt.a.error(t("Copy failed"))}catch(n){Yt.a.error("Fallback: Oops, unable to copy",n)}document.body.removeChild(a)}},{key:"render",value:function(){var e=this.props.t,t=this.props.form.getFieldDecorator,a=this.props.app.config?this.props.app.config.companyId:" pending... ";return this.widgetCode="<script> window.onload = () => { Omni.Widget({ companyId: '"+a+"' }); } <\/script>",r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("b",null,e("Copy this code into body of your HTML"))),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(Zt.a,{message:this.widgetCode,type:"info",style:{borderRadius:0}}),r.a.createElement($t.a,{type:"primary",icon:"copy",size:"large",style:{borderRadius:0},onClick:this.fallbackCopyTextToClipboard.bind(this)})),r.a.createElement("br",null),r.a.createElement(Wt.a,{onSubmit:this.handleSubmit,layout:"vertical"},r.a.createElement(ta,{label:e("Company name")},t("companyName",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.companyName:"",rules:[{required:!0}]})(r.a.createElement(Mt.a,{placeholder:e("Company name")}))),r.a.createElement(ta,{label:e("Widget is active")},t("isActive",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.isActive:"",rules:[]})(r.a.createElement(aa,null,r.a.createElement(Kt.a,{value:!0},e("Yes")),r.a.createElement(Kt.a,{value:!1},e("No"))))),r.a.createElement(ta,{label:e("Chat should be open?")},t("openChat",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.openChat:"",rules:[]})(r.a.createElement(aa,null,r.a.createElement(Kt.a,{value:!0},e("Yes")),r.a.createElement(Kt.a,{value:!1},e("No"))))),r.a.createElement(ta,{label:e("Widget color")},t("colorR",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.colorR:"",rules:[]})(r.a.createElement(ea.CirclePicker,{onChangeComplete:this.handleChange.bind(this)}))),r.a.createElement(ta,null,t("color",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.color:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:"Color picker soon ..."}))),r.a.createElement(Xt.a,{bordered:!1,accordion:!0,defaultActiveKey:["1"],onChange:this.callback},r.a.createElement(na,{header:"Telegram",key:"1"},r.a.createElement(ta,{label:e("Bot name")},t("telegram_bot_name",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.telegram_bot_name:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""}))),r.a.createElement(ta,{label:e("Bot token")},t("telegram_token",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.telegram_token:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""})))),r.a.createElement(na,{header:"Viber",key:"2"},r.a.createElement(ta,{label:e("Bot name")},t("viber_bot_name",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.viber_bot_name:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""}))),r.a.createElement(ta,{label:e("Bot token")},t("viber_token",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.viber_token:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""})))),r.a.createElement(na,{header:"Plusofon",key:"3"},r.a.createElement(ta,{label:e("Phone")},t("sms_phone",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.sms_phone:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""}))),r.a.createElement(ta,{label:e("API token")},t("sms_token",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.sms_token:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""})))),r.a.createElement(na,{header:"VK",key:"4"},r.a.createElement(ta,{label:e("Group name")},t("vk_group_name",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.vk_group_name:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""}))),r.a.createElement(ta,{label:e("Group token")},t("vk_token",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.vk_token:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""}))),r.a.createElement(ta,{label:e("Confirmation code")},t("vk_confirmation_code",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.vk_confirmation_code:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""})))),r.a.createElement(na,{header:"FB Messenger",key:"5"},r.a.createElement(ta,{label:e("API key")},t("fbm_api_key",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.fbm_api_key:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""}))),r.a.createElement(ta,{label:e("Secret")},t("fbm_secret",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.fbm_secret:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""}))),r.a.createElement(ta,{label:e("Page URL")},t("fbm_page",{initialValue:this.props.app.widgetSettings?this.props.app.widgetSettings.fbm_page:"",rules:[]})(r.a.createElement(Mt.a,{placeholder:""}))))),r.a.createElement(ta,null,r.a.createElement("br",null)),r.a.createElement(ta,null,r.a.createElement($t.a,{type:"primary",htmlType:"submit"},e("Save")))))}}]),t}(r.a.Component),sa=Wt.a.create()(ra),ca=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchSettings()}},{key:"render",value:function(){return r.a.createElement(sa,this.props)}}]),t}(r.a.Component),oa=Object(l.b)()(Object(m.b)(function(e,t){return{app:e.app}},function(e,t){return{fetchSettings:function(){e(It())},saveSettings:function(t){e(Tt(t))}}})(function(e){return r.a.createElement(ca,e)})),ia=a(603),ua=a(604),la=a(390),pa=a(272),ma=a(273),ha=a.n(ma),da=a(274),fa=a.n(da),ga=a(614),ba=a(602),va=a(599),Ea=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentDidMount",value:function(){this.client=JSON.parse(localStorage.getItem("XUSER")).data.userId}},{key:"render",value:function(){var e=this;return r.a.createElement(ga.a,{size:"small",dataSource:this.props.messages,renderItem:function(t){var a="string"===typeof t.ts?new Date(t.ts):new Date(t.ts.$date);if(t.u.name&&(t.u.name.length>15?t.u.shortName=t.u.name.substring(0,15)+"...":t.u.shortName=t.u.name),t.file)switch(t.file.type){case"image/png":t.fileLink=r.a.createElement("img",{height:"150px",src:"https://chat.mixapp.io/file-upload/"+t.file._id+"/"+t.file.name,alt:t.file.name});break;case"text/plain":t.fileLink=r.a.createElement("a",{href:"https://chat.mixapp.io/file-upload/"+t.file._id+"/"+t.file.name},t.file.name);break;default:t.fileLink=null}return r.a.createElement(ba.a,{key:t._id,author:r.a.createElement("b",null,t.u.shortName),avatar:r.a.createElement(Dt.a,{style:{backgroundColor:t.u._id===e.client?"#77a2ff":"#ff87a3"}},"U"),content:r.a.createElement("div",null,fa()(t.msg.replace(/\n/g,"<br/>")),r.a.createElement("div",null,t.fileLink?t.fileLink:"")),datetime:r.a.createElement(va.a,{title:""},r.a.createElement("span",null,function(e,t){var a=e.getDate(),n=t?{en:["January","February","March","April","May","June","July","August","September","October","November","December"],ru:["\u042f\u043d\u0432\u0430\u0440\u044c","\u0424\u0435\u0432\u0440\u0430\u043b\u044c","\u041c\u0430\u0440\u0442","\u0410\u043f\u0440\u0435\u043b\u044c","\u041c\u0430\u0439","\u0418\u044e\u043d\u044c","\u0418\u044e\u043b\u044c","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u041e\u043a\u0442\u044f\u0431\u0440\u044c","\u041d\u043e\u044f\u0431\u0440\u044c","\u0414\u0435\u043a\u0430\u0431\u0440\u044c"]}[t][e.getMonth()]:e.getMonth(),r=e.getFullYear(),s=e.getHours(),c=e.getMinutes();return("0"+(a+1)).slice(-2)+"."+("0"+(n+1)).slice(-2)+"."+r+", "+("0"+s).slice(-2)+":"+c}(a)))})}})}}]),t}(r.a.Component),ya=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"render",value:function(){return r.a.createElement("svg",{viewBox:"0 0 20 20",id:"icon-send",width:"100%",height:"100%",fill:"#c2c2c2"},r.a.createElement("path",{d:"M17.28 1.186L1.562 10.253a1.123 1.123 0 0 0 .134 2.01l4.919 2.035v3.58c0 1.059 1.326 1.518 1.99.711L10.734 16l4.434 1.832a1.122 1.122 0 0 0 1.537-.867L18.951 2.33c.144-.937-.863-1.61-1.67-1.144zM7.738 17.877v-3.116l1.912.79-1.912 2.326zm7.86-1.084l-7.236-2.99 7-8.273c.169-.197-.101-.463-.298-.295L6.105 12.87l-3.982-1.642 15.72-9.07-2.247 14.635z"}))}}]),t}(r.a.Component),Oa=Mt.a.TextArea,ka=Wt.a.Item,xa=pa.animateScroll,wa=function(e){function t(e){var a;return Object(pt.a)(this,t),(a=Object(ht.a)(this,Object(dt.a)(t).call(this,e))).state={currentRoom:null,hasMore:!0,pageItemsCount:15,currentPage:0,lm:null,messagesCount:0},a.handleSubmit=function(){a.props.form.validateFields(function(e,t){!e&&a.state.currentRoom&&t.userComment.replace(/\s/g,"").length&&a.props.sendMessage({room:a.state.currentRoom,roomId:a.state.currentRoom._id,text:t.userComment}),a.props.form.resetFields("userComment")})},a.fetchData=Object(ae.a)(ee.a.mark(function e(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.props.fetchDialog({count:a.state.currentPage*a.state.pageItemsCount,room:a.state.currentRoom});case 1:case"end":return e.stop()}},e,this)})),a.handleInfiniteOnLoad=Object(ae.a)(ee.a.mark(function e(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.state.currentPage*a.state.pageItemsCount>=a.state.messagesCount)){e.next=4;break}return Yt.a.warning("Infinite List loaded all"),a.setState({hasMore:!1}),e.abrupt("return");case 4:a.setState({currentPage:++a.state.currentPage}),a.fetchData(),a.scrollTo(150,{duration:0});case 7:case"end":return e.stop()}},e,this)})),a.lm=null,a}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"scrollToBottom",value:function(e){xa.scrollToBottom(Object(h.a)({containerId:"chat-conteiner"},e))}},{key:"scrollToTop",value:function(e){xa.scrollToTop(Object(h.a)({containerId:"chat-conteiner"},e))}},{key:"scrollTo",value:function(e,t){xa.scrollTo(e,Object(h.a)({containerId:"chat-conteiner"},t))}},{key:"sendMessage",value:function(e){"Enter"!==e.key||e.shiftKey||this.handleSubmit()}},{key:"componentDidUpdate",value:function(){var e=Object(ae.a)(ee.a.mark(function e(){var t,a,n,r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props,a=t.messages,n=t.message,a&&(r=a[a.length-1],this.lm?(n&&this.lm._id!==n._id&&(this.lm=r,this.scrollToBottom({duration:0})),0===this.state.currentPage&&this.scrollToBottom({duration:0})):(this.lm=r,this.scrollToBottom({duration:0})));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(){var e=Object(ae.a)(ee.a.mark(function e(){var t,a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.currentRoom,n=t.messagesCount,!a){e.next=7;break}if(!this.state.currentRoom||a._id===this.state.currentRoom._id){e.next=5;break}return e.next=5,this.setState({hasMore:!0,currentPage:0});case 5:return e.next=7,this.setState({currentRoom:a});case 7:if(!n){e.next=10;break}return e.next=10,this.setState({messagesCount:n});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.setState({currentRoom:null,lm:null})}},{key:"componentDidMount",value:function(){for(var e,t,a,n=document.getElementsByTagName("textarea"),r=0;r<n.length;r++)n[r].setAttribute("style","height:"+n[r].scrollHeight+"px;"),n[r].addEventListener("input",s,!1);function s(){this.scrollHeight<100&&(this.style.height="auto",this.style.height=this.scrollHeight+"px",this.scrollHeight-50>-1&&(t.style.height=a-(this.scrollHeight-50)+"px"))}setTimeout(function(){e=document.getElementsByClassName("content dialogs")[0],t=document.getElementsByClassName("chat-conteiner")[0],a=e.clientHeight-55,t.style.height=a+"px"},0)}},{key:"render",value:function(){this.state.currentRoom;var e=this.props.form,t=e.getFieldError,a=e.isFieldTouched,n=e.getFieldDecorator,s=a("userComment")&&t("userComment");return[r.a.createElement(ia.a,{key:"1"},r.a.createElement(ua.a,{span:24,style:{overflow:"hidden",border:"none"}},r.a.createElement(qt.a,{spinning:this.props.loader,delay:0},r.a.createElement("div",{className:"chat-conteiner",id:"chat-conteiner"}," ",r.a.createElement(ha.a,{initialLoad:!1,isReverse:!0,loadMore:this.handleInfiniteOnLoad,hasMore:!this.state.loading&&this.state.hasMore,useWindow:!1,threshold:5},r.a.createElement(Ea,{messages:this.props.messages}))))),r.a.createElement(ua.a,{span:0})),r.a.createElement(ia.a,{key:"2"},r.a.createElement(ua.a,{span:24},r.a.createElement(Wt.a,{onSubmit:this.handleSubmit},r.a.createElement(ka,{validateStatus:s?"error":"",help:s||"",style:{marginBottom:"0"}},r.a.createElement("div",{style:{display:"flex"}},n("userComment",{rules:[{required:!0,message:"Please input your message!"}]})(r.a.createElement(Oa,{placeholder:"You commnet ...",onKeyUp:this.sendMessage.bind(this)})),r.a.createElement("div",{onClick:this.handleSubmit,className:"send-button"},r.a.createElement(ya,null)))))))]}}]),t}(r.a.Component),ja=Wt.a.create()(wa),Sa=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchDialogs(),this.props.loaderOff()}},{key:"render",value:function(){var e=this.props.t;return this.props.app.currentRoom?r.a.createElement(ja,{loader:this.props.app.loader,messagesCount:this.props.app.messagesCount,currentRoom:this.props.app.currentRoom,fetchDialog:this.props.fetchDialog,messages:this.props.app.messages,message:this.props.app.message,dialogs:this.props.app.dialogs,sendMessage:this.props.sendMessage}):r.a.createElement(ia.a,{style:{height:"100%"},type:"flex",justify:"space-around",align:"middle"},r.a.createElement(ua.a,{span:20},r.a.createElement(la.a,{image:"https://gw.alipayobjects.com/mdn/miniapp_social/afts/img/A*pevERLJC9v0AAAAAAAAAAABjAQAAAQ/original",description:r.a.createElement("span",null,e("First of all select a dialog"))})))}}]),t}(r.a.Component),_a=Object(l.b)()(Object(m.b)(function(e,t){return{app:e.app}},function(e,t){return{fetchDialogs:function(){e({type:D})},fetchDialog:function(t){e(At(t))},sendMessage:function(t){e(function(e){return{type:q,data:e}}(t))},loaderOff:function(){e(Rt())}}})(function(e){return r.a.createElement(Sa,e)})),Ca=a(609),Ia=a(606),Ta=Wt.a.Item,Aa=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentDidUpdate",value:function(){var e=this.props.t;this.props.app.error_message&&this.props.app.error_message.error&&Yt.a.error(e(this.props.app.error_message.error_message))}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,s=e.form,c=e.t,o=s.getFieldDecorator,i={wrapperCol:{xs:{span:12},sm:{span:14}}};return r.a.createElement(Ca.a,{visible:t,title:c("buttons.addManager"),okText:c("Add"),cancelText:c("Cancel"),onCancel:a,onOk:n},r.a.createElement(Wt.a,{layout:"vertical"},r.a.createElement(Ta,Object.assign({},i,{label:c("Email")}),o("email",{rules:[{required:!0,message:c("This field is required")}]})(r.a.createElement(Mt.a,{placeholder:"email@gmail.com"}))),r.a.createElement(Ta,Object.assign({},i,{label:c("Nickname")}),o("nickname",{rules:[{required:!0,message:c("This field is required")}]})(r.a.createElement(Mt.a,{placeholder:"BestNickname"}))),r.a.createElement(Ta,Object.assign({},i,{label:c("Password")}),o("password",{rules:[{required:!0,message:c("This field is required")}]})(r.a.createElement(Mt.a,{placeholder:"*********",type:"password"})))))}}]),t}(r.a.Component),Ra=Wt.a.create()(Aa),Ma=Ca.a.confirm,Da=function(e){function t(){var e,a;Object(pt.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(ht.a)(this,(e=Object(dt.a)(t)).call.apply(e,[this].concat(r)))).state={size:"small",managers:[],visible:!1},a.showModal=function(){a.setState({visible:!0})},a.handleCancel=function(){a.setState({visible:!1})},a.handleCreate=function(e){var t=a.formRef.props.form;e.preventDefault(),t.validateFields(function(e,n){e||(a.props.addManager(n),t.resetFields(),a.setState({visible:!1}))})},a.saveFormRef=function(e){a.formRef=e},a}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"showConfirm",value:function(e){var t=this.props,a=t.removeManager,n=t.t;Ma({title:n("Do you want to delete manager?"),okText:n("Yes"),cancelText:n("Cancel"),onOk:function(){a(e)},onCancel:function(){}})}},{key:"render",value:function(){var e=this,t=this.props.t,a=[{title:"\u2116",dataIndex:"number",key:"number"},{title:t("Email"),dataIndex:"email",key:"email"},{title:t("Nickname"),key:"nickname",dataIndex:"nickname"},{title:t("Action"),dataIndex:"",key:"",render:function(a){function n(){return(n=Object(ae.a)(ee.a.mark(function e(){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.showConfirm(a),e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),e.t0;case 7:case"end":return e.stop()}},e,this,[[0,4]])}))).apply(this,arguments)}return r.a.createElement($t.a,{onClick:function(){return n.apply(this,arguments)}.bind(e),type:"danger"},t("Delete"))},fixed:"right",width:100}];return r.a.createElement("div",null,r.a.createElement($t.a,{type:"primary",onClick:this.showModal,style:{marginBottom:"20px"}},t("buttons.addManager")),r.a.createElement(Ia.a,Object.assign({},this.state,{columns:a,dataSource:this.props.app.managers})),r.a.createElement(Ra,Object.assign({wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,onCreate:this.handleCreate},this.props)))}}]),t}(r.a.Component),Na=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchManagers()}},{key:"render",value:function(){return r.a.createElement(Da,this.props)}}]),t}(r.a.Component),Ua=Object(l.b)()(Object(m.b)(function(e,t){return{app:e.app}},function(e,t){return{fetchManagers:function(){e({type:_})},addManager:function(t){e(function(e){return{type:I,data:e}}(t))},removeManager:function(t){e(function(e){return{type:R,data:e}}(t))}}})(function(e){return r.a.createElement(Na,e)})),La=function(e){function t(){var e,a;Object(pt.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(ht.a)(this,(e=Object(dt.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!1,msgsIdToDelete:[]},a.deleteRequest=function(){var e=Object(ae.a)(ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a.setState({loading:!0}),a.props.deleteRequest(t),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}},e,this,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.rowSelection={onChange:function(){var e=Object(ae.a)(ee.a.mark(function e(t,n){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({msgsIdToDelete:n});case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}},a}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentWillReceiveProps",value:function(){this.props.app.requests&&this.setState({loading:!1})}},{key:"render",value:function(){var e=this,t=this.props.t,a=[{title:t("Message"),render:function(e){return r.a.createElement("div",null,r.a.createElement(ia.a,null,r.a.createElement(ua.a,{span:3},r.a.createElement("b",null,"\u043e\u0442: ",e.u.username))),r.a.createElement(ia.a,null,r.a.createElement(ua.a,{span:24},e.msg)),r.a.createElement("br",null),r.a.createElement(ia.a,null,r.a.createElement(ua.a,{style:{fontSize:"0.5em",color:"grey"},span:3},e.ts)))},key:"msg"},{title:t("Action"),key:"_id",render:function(a){return r.a.createElement($t.a,{onClick:function(){this.state.msgsIdToDelete.length>0?this.deleteRequest(this.state.msgsIdToDelete):this.deleteRequest(a)}.bind(e),type:"danger"},t("Delete"))},fixed:"right",width:100}];return r.a.createElement(Ia.a,{rowSelection:this.rowSelection,scroll:{x:1800},pagination:{hideOnSinglePage:!0},loading:this.state.loading,columns:a,dataSource:this.props.app.requests})}}]),t}(r.a.Component),Pa=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchRequests()}},{key:"render",value:function(){return r.a.createElement(La,this.props)}}]),t}(r.a.Component),Fa=Object(l.b)()(Object(m.b)(function(e,t){return{app:e.app}},function(e,t){return{fetchRequests:function(t){e(function(e){return{type:Q,data:e}}(t))},deleteRequest:function(t){e(function(e){return{type:W,data:e}}(t))}}})(function(e){return r.a.createElement(Pa,e)})),qa=function(e){function t(){return Object(pt.a)(this,t),Object(ht.a)(this,Object(dt.a)(t).apply(this,arguments))}return Object(ft.a)(t,e),Object(mt.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchRole(),this.props.loaderOff(),"/"===ct.location.pathname&&ct.push("/dialogs")}},{key:"render",value:function(){return r.a.createElement(v.a,{history:ct},r.a.createElement("div",null,r.a.createElement(gt.a,{path:"/authorize",exact:!0,component:Jt}),r.a.createElement(zt,{role:this.props.app.role,loader:this.props.app.loader},r.a.createElement(Et,{path:"/",exact:!0,component:Ot}),r.a.createElement(Et,{path:"/settings",exact:!0,component:oa}),r.a.createElement(Et,{path:"/dialogs",exact:!0,component:_a}),r.a.createElement(Et,{path:"/managers",exact:!0,component:Ua}),r.a.createElement(Et,{path:"/requests",exact:!0,component:Fa}))))}}]),t}(r.a.Component),Ga=Object(m.b)(function(e,t){return{app:e.app}},function(e,t){return{fetchSettings:function(){e(It())},saveSettings:function(t){e(Tt(t))},fetchRole:function(){e({type:B})},loaderOff:function(){e(Rt())}}})(qa);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(595);c.a.render(r.a.createElement(m.a,{store:lt},r.a.createElement(Ga,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[282,2,1]]]);
//# sourceMappingURL=main.3b422775.chunk.js.map